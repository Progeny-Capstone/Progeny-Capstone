<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="partials/head :: head('Progeny - Profile')">

</head>
<body sec:authorize="isAuthenticated()">

<!---------- TOP NAVIGATION BAR ---------->
<nav th:replace="partials/topnav :: navbar"></nav>

<!---------- MAIN CONTAINER ---------->
<article class="main-container">

    <!---------- PROFILE NAVIGATION ---------->
    <section class="jumbotron greeting-jumbotron mt-5">
        <h1 class="section-header">Welcome back, <span th:text="${currentUser.firstName}"></span>!</h1>
    </section>

    <!---------- PROFILE NAVIGATION ---------->
    <nav class="section-container mt-5 mb-2" id="profile-nav">

        <!---------- PROFILE NAVIGATION LIST ---------->
        <ul class="nav d-flex flex-row justify-content-between row ">

            <!---------- PROFILE NAVIGATION LIST ITEMS ---------->
            <li class=" py-3 profile-nav-item text-center col-12 col-md-4 ">
                <a href="/profile" class="d-flex flex-column align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         class="profile-section--graphic mb-1">
                        <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"/>
                    </svg>
                    Profile
                </a>
            </li>
            <li class=" py-3 profile-nav-item text-center col-12 col-md-4 ">
                <a href="/profile/friends" class="d-flex flex-column align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         class="profile-section--graphic mb-1">
                        <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 22c-3.123 0-5.914-1.441-7.749-3.69.259-.588.783-.995 1.867-1.246 2.244-.518 4.459-.981 3.393-2.945-3.155-5.82-.899-9.119 2.489-9.119 3.322 0 5.634 3.177 2.489 9.119-1.035 1.952 1.1 2.416 3.393 2.945 1.082.25 1.61.655 1.871 1.241-1.836 2.253-4.628 3.695-7.753 3.695z"/>
                    </svg>
                    Friends
                </a>
            </li>
            <li class=" py-3 profile-nav-item text-center col-12 col-md-4 ">
                <a href="/profile/edit/{id}" class="d-flex flex-column align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         class="profile-section--graphic mb-1">
                        <path d="M24 14.187v-4.374c-2.148-.766-2.726-.802-3.027-1.529-.303-.729.083-1.169 1.059-3.223l-3.093-3.093c-2.026.963-2.488 1.364-3.224 1.059-.727-.302-.768-.889-1.527-3.027h-4.375c-.764 2.144-.8 2.725-1.529 3.027-.752.313-1.203-.1-3.223-1.059l-3.093 3.093c.977 2.055 1.362 2.493 1.059 3.224-.302.727-.881.764-3.027 1.528v4.375c2.139.76 2.725.8 3.027 1.528.304.734-.081 1.167-1.059 3.223l3.093 3.093c1.999-.95 2.47-1.373 3.223-1.059.728.302.764.88 1.529 3.027h4.374c.758-2.131.799-2.723 1.537-3.031.745-.308 1.186.099 3.215 1.062l3.093-3.093c-.975-2.05-1.362-2.492-1.059-3.223.3-.726.88-.763 3.027-1.528zm-4.875.764c-.577 1.394-.068 2.458.488 3.578l-1.084 1.084c-1.093-.543-2.161-1.076-3.573-.49-1.396.581-1.79 1.693-2.188 2.877h-1.534c-.398-1.185-.791-2.297-2.183-2.875-1.419-.588-2.507-.045-3.579.488l-1.083-1.084c.557-1.118 1.066-2.18.487-3.58-.579-1.391-1.691-1.784-2.876-2.182v-1.533c1.185-.398 2.297-.791 2.875-2.184.578-1.394.068-2.459-.488-3.579l1.084-1.084c1.082.538 2.162 1.077 3.58.488 1.392-.577 1.785-1.69 2.183-2.875h1.534c.398 1.185.792 2.297 2.184 2.875 1.419.588 2.506.045 3.579-.488l1.084 1.084c-.556 1.121-1.065 2.187-.488 3.58.577 1.391 1.689 1.784 2.875 2.183v1.534c-1.188.398-2.302.791-2.877 2.183zm-7.125-5.951c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.762 0-5 2.238-5 5s2.238 5 5 5 5-2.238 5-5-2.238-5-5-5z"/>
                    </svg>
                    Settings
                </a>
            </li>

        </ul>

    </nav>

    <!---------- USER ACCOUNT DETAILS ---------->
    <section class="section-container profile-details-container row p-5 my-3 d-flex flex-row justify-content-between">

        <!---------- USER PROFILE IMAGE CONTAINER ---------->
        <div class="col-12 col-md-2">

            <!---------- USER PROFILE IMAGE ---------->
            <div class="profile-image-container">
                <img th:src=" @{ ${currentUser.getProfileImageUrl()}}" alt="The current user's profile image"
                     class="rounded-circle mx-auto">
            </div>

        </div>

        <!---------- USER DETAILS ---------->
        <div class="col-12 col-md-8">
            <!---------- EDIT PROFILE LINK ---------->
            <a href="/profile/edit/{id}">Edit Profile</a>

            <!---------- USER FULL NAME ---------->
            <p class="text-left full-name-title section-subheader text-wrap m-0"><span
                    th:text="${currentUser.getFirstName()} + ' ' + ${currentUser.getLastName()}"></span></p>

            <!---------- USERNAME ---------->
            <p class="text-left m-0 user-bio "><span th:text="${currentUser.getUsername()}"></span></p>

            <!---------- USER LOCATION ---------->
            <p class="text-left user-location m-0">
                <span th:text="${currentUser.getLocation()}"></span></p>

            <!---------- USER BIO ---------->
            <p class="text-left user-bio pt-4"><span th:text="${currentUser.bio}"></span></p>

        </div>

        <!---------- STATS CONTAINER ---------->
        <div class="col-12 col-md-2 d-flex flex-column justify-content-center">

            <!---------- FRIENDS COUNT ---------->
            <span class="mb-3 p-3 profile-badge text-center"><strong
                    th:text="${friends.size()}"></strong> friend(s)</span>

            <!---------- RECORDINGS COUNT ---------->
            <span class="mb-3 p-3 profile-badge text-center"><strong th:text="${recordings.size()}"></strong> recording(s)</span>

        </div>

    </section>

    <!---------- USER CONTENT ---------->
    <section class="section-container d-flex flex-row flex-grow-1 mt-2">

        <!---------- USER'S RECORDINGS SECTION---------->
        <div class="recording-sub-section d-flex flex-column flex-grow-1 mr-2 p-5">

            <h3 class="recording-section-header">Your Recordings</h3>

            <!---------- CREATE RECORDINGS CARD---------->
            <a class="recording-card-add my-3" href="/stories">

                <div class="d-flex flex-column justify-content-center mx-auto p-5">

                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         class="add-recording-graphic mx-auto mb-3">
                        <path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6 13h-5v5h-2v-5h-5v-2h5v-5h2v5h5v2z"/>
                    </svg>

                    <p class="add-recording-title card-link text-center mb-0">Add Recording</p>

                </div>

            </a>


            <!---------- RECORDING CARD ---------->
            <div th:each="recording : ${recordings}"
                 class="recording-card my-3 p-3 d-flex flex-column justify-content-center">

                <!---------- RECORDING TITLE---------->
                <a class="blue-link" th:href="@{|/recording/show/${recording.getId()}|}">
                    <h3 th:text="${recording.title}" class="recording-title text-center"></h3>
                </a>

                <!---------- RECORDING CREATOR---------->
                <p class="story-author text-center">Created by
                    <a class="story-author" href="/profile/friends"><em
                            th:text="${recording.getUser().username}"></em></a>
                </p>

                <!---------- RECORDING CONTROLER ---------->
                <audio controls class="mx-auto">
                    <source th:src="${recording.recordingUrl}"
                            type='audio/mp4'>

                    <!-- The next two lines are only executed if the browser doesn't support MP4 files -->
                    <source th:src="${recording.recordingUrl}"
                            type='audio/ogg; codecs=vorbis'>

                    <!-- The next line will only be executed if the browser doesn't support the <audio> tag-->
                    <p>Your browser does not support the HTML5 Audio element.</p>

                </audio>

            </div>

        </div>

        <!---------- FRIEND'S RECORDING(s )---------->
        <div class="friend-recording-sub-section d-flex flex-column flex-grow-1 ml-2 p-5">

            <h3 class="recording-section-header">Friend's Recordings</h3>

            <!---------- FRIEND'S RECORDING(s ) CARDS---------->
            <div th:each="friend : ${friends}" th:if="${friend.isAccepted()}">

                <!---------- RECORDING CARD ---------->
                <div th:each="recording : ${friend.getFriend().getRecordings()}"
                     class="recording-card my-3 p-3 d-flex flex-column justify-content-center">

                    <!---------- RECORDING TITLE---------->
                    <h3 th:text="${recording.title}" class="recording-title text-center"></h3>

                    <!---------- RECORDING CREATOR---------->
                    <p class="story-author text-center">Created by <em th:text="${recording.getUser().username}"></em>
                    </p>

                    <!---------- RECORDING AUDIO CONTROLLER ---------->
                    <audio controls class="mx-auto">
                        <source th:src="${recording.recordingUrl}"
                                type='audio/mp4'>

                        <!-- The next two lines are only executed if the browser doesn't support MP4 files -->
                        <source th:src="${recording.recordingUrl}" type='audio/ogg; codecs=vorbis'>

                        <!-- The next line will only be executed if the browser doesn't support the <audio> tag-->
                        <p>Your browser does not support the HTML5 Audio element.</p>

                    </audio>

                </div>

            </div>

        </div>

    </section>

</article>


<!---------- FOOTER ---------->
<nav th:replace="partials/footer :: footer"></nav>

<!---------- SCRIPTS ---------->
<script th:replace="partials/scripts :: scripts"></script>

</body>
</html>